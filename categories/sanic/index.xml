<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Sanic on Lllama's blog</title><link>https://lllama.github.io/categories/sanic/</link><description>Recent content in Sanic on Lllama's blog</description><generator>Hugo</generator><language>en-gb</language><lastBuildDate>Mon, 17 Apr 2023 20:35:00 +0100</lastBuildDate><atom:link href="https://lllama.github.io/categories/sanic/index.xml" rel="self" type="application/rss+xml"/><item><title>sanic-kit</title><link>https://lllama.github.io/posts/sanic-kit/</link><pubDate>Mon, 17 Apr 2023 20:35:00 +0100</pubDate><guid>https://lllama.github.io/posts/sanic-kit/</guid><description>&lt;p&gt;&lt;a href="https://htmx.org/"&gt;HTMx&lt;/a&gt; has been a revelation for writing web apps. I’d previously used my preferred DERP stack (Django, Ember, REST framework, postgresql) which produced nice enough apps but took a lot of effort and had lots of redundant code: Postgres tables needed to be Django models, which needed to be DRF serialisers, which needed Ember Data models, and then finally rendered to the DOM.&lt;/p&gt;
&lt;p&gt;Writing with htmx meant I could have most of the shiny but I only need to produce the html on the server.&lt;/p&gt;</description></item><item><title>URLs are harder than they should be</title><link>https://lllama.github.io/posts/urls-suck/</link><pubDate>Tue, 24 Jan 2023 16:13:28 +0000</pubDate><guid>https://lllama.github.io/posts/urls-suck/</guid><description>&lt;p&gt;My current toy web-app is a webmail client. It provides the standard inbox view and then let’s you drill down to view actual mails. I also then have actions you can perform on these.&lt;/p&gt;
&lt;p&gt;The URLs for these are fairly basic:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/mailbox/&amp;lt;ID&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/mailbox/&amp;lt;ID&amp;gt;/&amp;lt;mail ID&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/mailbox/&amp;lt;ID&amp;gt;/&amp;lt;mail ID&amp;gt;/delete&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So far, so whatever. The pain comes with how to construct the drill down urls from the current page. I can get the current URL in my templates with &lt;code&gt;request.url&lt;/code&gt; and then append &lt;code&gt;/whatever&lt;/code&gt;. This works until I have a link with a trailing slash. Then my urls end up with double slashes and Sanic responds with a 404.&lt;/p&gt;</description></item><item><title>Sanic Custom Route Parameters</title><link>https://lllama.github.io/posts/sanic-custom-parameters/</link><pubDate>Mon, 23 Jan 2023 12:11:33 +0000</pubDate><guid>https://lllama.github.io/posts/sanic-custom-parameters/</guid><description>&lt;p&gt;Sanic supports path parameters like the majority of web frameworks. It supports a number of &lt;a href="https://sanic.dev/en/guide/basics/routing.html#path-parameters"&gt;built-in types&lt;/a&gt; but you can define your own.&lt;/p&gt;
&lt;p&gt;Something like this from Adam on Discord:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; re
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; typing &lt;span style="color:#f92672"&gt;import&lt;/span&gt; NamedTuple
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;DIMENSIONS_PATTERN &lt;span style="color:#f92672"&gt;=&lt;/span&gt; re&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compile(&lt;span style="color:#e6db74"&gt;r&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;(?P&amp;lt;width&amp;gt;\d+)x(?P&amp;lt;height&amp;gt;\d+)&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Dimensions&lt;/span&gt;(NamedTuple):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; width: int
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; height: int
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;_extract_dimensions&lt;/span&gt;(value: str) &lt;span style="color:#f92672"&gt;-&amp;gt;&lt;/span&gt; Dimensions:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;match&lt;/span&gt; &lt;span style="color:#f92672"&gt;:=&lt;/span&gt; DIMENSIONS_PATTERN&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;match&lt;/span&gt;(value):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; Dimensions(&lt;span style="color:#f92672"&gt;**&lt;/span&gt;{k: int(v) &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; k, v &lt;span style="color:#f92672"&gt;in&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;match&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;groupdict()&lt;span style="color:#f92672"&gt;.&lt;/span&gt;items()})
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;raise&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;ValueError&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Not proper dimensions format&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;app&lt;span style="color:#f92672"&gt;.&lt;/span&gt;router&lt;span style="color:#f92672"&gt;.&lt;/span&gt;register_pattern(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;dimensions&amp;#34;&lt;/span&gt;, _extract_dimensions, DIMENSIONS_PATTERN
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.get&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/&amp;lt;dimensions:dimensions&amp;gt;/colors/&amp;lt;hex:ext&amp;gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;async&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;handler&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; request: Request, dimensions: Dimensions, hex: str, ext: str
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; json({&lt;span style="color:#e6db74"&gt;&amp;#34;dimensions&amp;#34;&lt;/span&gt;: dimensions, &lt;span style="color:#e6db74"&gt;&amp;#34;hex&amp;#34;&lt;/span&gt;: hex, &lt;span style="color:#e6db74"&gt;&amp;#34;ext&amp;#34;&lt;/span&gt;: ext})
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>